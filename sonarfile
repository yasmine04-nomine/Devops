pipeline {
  agent any

 stage('SonarQube Analysis') {
  steps {
    withSonarQubeEnv('sonarqube') {
      withCredentials([string(credentialsId: 'sonar-token', variable: 'SONAR_TOKEN')]) {
        sh '''
          mvn -B clean package -DskipTests sonar:sonar \
            -Dsonar.host.url=$SONAR_HOST_URL \
            -Dsonar.token=$SONAR_TOKEN
        '''
      }
    }
  }
}
}
